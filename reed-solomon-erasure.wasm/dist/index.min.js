const currentScript=globalThis.document&&globalThis.document.currentScript;!function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports);void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define(["require","exports","fs"],e)}((function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=e("fs");class _{constructor(e){this.exports=e,this.memoryCache=null}static async fromCurrentDirectory(){if(currentScript){const e=currentScript.src.split("/").slice(0,-1).join("/");return _.fromResponse(fetch(`${e}/reed_solomon_erasure_bg.wasm`))}return _.fromBytes(r.readFileSync(`${__dirname}/reed_solomon_erasure_bg.wasm`))}static async fromResponse(e){const{instance:t}=await WebAssembly.instantiateStreaming(e);return new _(t.exports)}static fromBytes(e){const t=new WebAssembly.Module(e),r=new WebAssembly.Instance(t);return new _(r.exports)}encode(e,t,r){const n=this.exports,s=e.length,o=n.__wbindgen_malloc(s);this.getUint8Memory().set(e,o);const R=s/(t+r),i=n.encode(o,s,t,r);return i===_.RESULT_OK&&e.set(this.getUint8Memory().subarray(o+R*t,o+s),R*t),n.__wbindgen_free(o,s),i}reconstruct(e,t,r,n){const s=this.exports,o=e.length,R=s.__wbindgen_malloc(o);this.getUint8Memory().set(e,R);const i=n.length,c=s.__wbindgen_malloc(i);this.getUint8Memory().set(n.map(e=>e?1:0),c);const S=o/(t+r),E=s.reconstruct(R,o,t,r,c,i);return E===_.RESULT_OK&&e.set(this.getUint8Memory().subarray(R,R+S*t)),s.__wbindgen_free(R,o),s.__wbindgen_free(c,i),E}getUint8Memory(){let e=this.memoryCache;return null!==e&&e.buffer===this.exports.memory.buffer||(e=new Uint8Array(this.exports.memory.buffer),this.memoryCache=e),e}}t.ReedSolomonErasure=_,_.RESULT_OK=0,_.RESULT_ERROR_TOO_FEW_SHARDS=1,_.RESULT_ERROR_TOO_MANY_SHARDS=2,_.RESULT_ERROR_TOO_FEW_DATA_SHARDS=3,_.RESULT_ERROR_TOO_MANY_DATA_SHARDS=4,_.RESULT_ERROR_TOO_FEW_PARITY_SHARDS=5,_.RESULT_ERROR_TOO_MANY_PARITY_SHARDS=6,_.RESULT_ERROR_TOO_FEW_BUFFER_SHARDS=7,_.RESULT_ERROR_TOO_MANY_BUFFER_SHARDS=8,_.RESULT_ERROR_INCORRECT_SHARD_SIZE=9,_.RESULT_ERROR_TOO_FEW_SHARDS_PRESENT=10,_.RESULT_ERROR_EMPTY_SHARD=11,_.RESULT_ERROR_INVALID_SHARD_FLAGS=12,_.RESULT_ERROR_INVALID_INDEX=13}));
